apiVersion: gitops.weave.works/v1alpha1
kind: GitopsCluster
metadata:
  annotations:
    templates.weave.works/create-request: '{"head_branch":"edit-cluster-temp1-branch-jvoq2l","title":"Edits
      cluster temp1","description":"This PR edits the cluster","template_name":"aws-eks","parameter_values":{"AWS_REGION":"eu-north-1","CLUSTER_NAME":"temp1","INSTANCE_TYPE":"t3.medium","KUBERNETES_VERSION":"v1.23.7","OWNER_EMAIL":"rana.hassan@weave.works","SSH_KEY_NAME":"temp1","WORKER_MACHINE_COUNT":"1"},"commit_message":"Edits
      capi cluster temp1","credentials":{},"values":[{"name":"weave-policy-agent","version":"0.5.4","values":"CnBvbGljeS1hZ2VudDoKICBmYWlsdXJlUG9saWN5OiBJZ25vcmUKCiAgIyBJZiB5b3UgZG9uJ3Qgd2FudCB0byB1c2UgY2VydC1tYW5hZ2VyLCBzZXQgdXNlQ2VydE1hbmFnZXIgdG8gZmFsc2UgYW5kIHByb3ZpZGUgeW91ciBvd24gY2VydHMKICB1c2VDZXJ0TWFuYWdlcjogZmFsc2UKICBjZXJ0aWZpY2F0ZTogIiIKICBrZXk6ICIiCiAgY2FDZXJ0aWZpY2F0ZTogIiIKCiAgcGVyc2lzdGVuY2U6CiAgICBlbmFibGVkOiBmYWxzZQogICAgIyBjbGFpbVN0b3JhZ2U6IDFHaQogICAgIyBzaW5rRGlyOiAvdG1wCiAgICAjIHN0b3JhZ2VDbGFzc05hbWU6IHN0YW5kYXJkCgogIGNvbmZpZzoKICAgIGFjY291bnRJZDogIiIKICAgIGNsdXN0ZXJJZDogIiIKCiAgICBhdWRpdDoKICAgICAgIyBEaXNhYmxlIGF1ZGl0IGZ1bmN0aW9uYWxpdHkKICAgICAgZW5hYmxlZDogZmFsc2UKCiAgICBhZG1pc3Npb246CiAgICAgICMgRW5hYmxlIGFkbWlzc2lvbiBmdW5jdGlvbmFsaXR5CiAgICAgIGVuYWJsZWQ6IHRydWUKICAgICAgIyBtdXRhdGU6IHRydWUgIyBlbmFibGUgbXV0YXRpbmcgdmlvbGF0aW5nIHJlc291cmNlcwogICAgICBzaW5rczoKICAgICAgICAjIEVuYWJsZSB3cml0aW5nIHZpb2xhdGlvbnMgYXMgSzhzIGV2ZW50cwogICAgICAgIGs4c0V2ZW50c1Npbms6CiAgICAgICAgICBlbmFibGVkOiB0cnVlCgpwb2xpY3lTb3VyY2U6CiAgZW5hYmxlZDogZmFsc2UKICAjIHVybDogc3NoOi8vZ2l0QGdpdGh1Yi5jb20vd2VhdmV3b3Jrcy9wb2xpY3ktbGlicmFyeQogICMgdGFnOiB2MS4wLjAKICAjIGJyYW5jaDoKICAjIHBhdGg6IC4vICAjIENvdWxkIGJlIGEgcGF0aCB0byB0aGUgcG9saWNpZXMgZGlyIG9yIGEga3VzdG9taXphdGlvbi55YW1sIGZpbGUKICAjIHNlY3JldFJlZjogcG9saWN5LWxpYnJhcnktYXV0aCAgIyAoT3B0aW9uYWwpOiBOYW1lIG9mIHRoZSBLOHMgc2VjcmV0IHdpdGggcHJpdmF0ZSByZXBvIGF1dGggY3JlZGVudGlhbHMKICAjIHNvdXJjZVJlZjogIyBDb3VsZCBzcGVjaWZ5IGEgbmFtZSBmb3IgYW4gZXhpc3RpbmcgR2l0U291cmNlIHJlZmVyZW5jZSBpbnN0ZWFkIG9mIGNyZWF0aW5nIGEgbmV3IG9uZQogICMgICBraW5kOiBHaXRSZXBvc2l0b3J5CiAgIyAgIG5hbWU6IHBvbGljeS1saWJyYXJ5CiAgIyAgIG5hbWVzcGFjZTogZmx1eC1zeXN0ZW0K","layer":"layer-1"}]}'
  labels:
    templates.weave.works/template-name: aws-eks
    templates.weave.works/template-namespace: default
    weave.works/capi: bootstrap
  name: temp1
  namespace: default
spec:
  capiClusterRef:
    name: temp1

---
apiVersion: cluster.x-k8s.io/v1beta1
kind: Cluster
metadata:
  labels:
    templates.weave.works/template-name: aws-eks
    templates.weave.works/template-namespace: default
  name: temp1
  namespace: default
spec:
  clusterNetwork:
    pods:
      cidrBlocks:
      - 10.120.0.0/20
  controlPlaneRef:
    apiVersion: controlplane.cluster.x-k8s.io/v1beta1
    kind: AWSManagedControlPlane
    name: temp1-control-plane
  infrastructureRef:
    apiVersion: controlplane.cluster.x-k8s.io/v1beta1
    kind: AWSManagedControlPlane
    name: temp1-control-plane

---
apiVersion: controlplane.cluster.x-k8s.io/v1beta1
kind: AWSManagedControlPlane
metadata:
  annotations:
    kustomize.toolkit.fluxcd.io/prune: disabled
  labels:
    templates.weave.works/template-name: aws-eks
    templates.weave.works/template-namespace: default
  name: temp1-control-plane
  namespace: default
spec:
  additionalTags:
    creator: rana.hassan@weave.works
  iamAuthenticatorConfig:
    mapRoles:
    - groups:
      - system:masters
      rolearn: arn:aws:iam::894516026745:role/AdministratorAccess
      username: admin
    - groups:
      - system:masters
      rolearn: arn:aws:iam::894516026745:role/WeaveEksEditor
      username: admin
  region: eu-north-1
  sshKeyName: temp1
  version: v1.23.7

---
apiVersion: cluster.x-k8s.io/v1beta1
kind: MachinePool
metadata:
  annotations:
    kustomize.toolkit.fluxcd.io/prune: disabled
  labels:
    templates.weave.works/template-name: aws-eks
    templates.weave.works/template-namespace: default
  name: temp1-pool-0
  namespace: default
spec:
  clusterName: temp1
  replicas: 1
  template:
    spec:
      bootstrap:
        dataSecretName: ""
      clusterName: temp1
      infrastructureRef:
        apiVersion: infrastructure.cluster.x-k8s.io/v1beta1
        kind: AWSManagedMachinePool
        name: temp1-pool-0

---
apiVersion: infrastructure.cluster.x-k8s.io/v1beta1
kind: AWSManagedMachinePool
metadata:
  annotations:
    kustomize.toolkit.fluxcd.io/prune: disabled
  labels:
    templates.weave.works/template-name: aws-eks
    templates.weave.works/template-namespace: default
  name: temp1-pool-0
  namespace: default
spec:
  additionalTags:
    creator: rana.hassan@weave.works
  instanceType: t3.medium
