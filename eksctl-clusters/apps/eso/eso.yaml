apiVersion: infra.contrib.fluxcd.io/v1alpha1
  kind: Terraform
  metadata:
    name: eso
    namespace: flux-system
  spec:
    interval: 1h
    retryInterval: 20s
    path: ./eksctl-clusters/terraform/eso
    approvePlan: auto
    destroyResourcesOnDeletion: true
    vars:
      - name: cluster_name
        value: '{{ .params.CLUSTER_NAME }}'
      - name: region
        value: '{{ .params.AWS_REGION }}'
      - name: target_path
        value: 'clusters/default/{{ .params.CLUSTER_NAME }}'
      - name: desired_size
        value: '{{ .params.DESIRED_SIZE }}'
      - name: min_size
        value: '{{ .params.MIN_SIZE }}'
      - name: max_size
        value: '{{ .params.MAX_SIZE }}'
      - name: capacity_type
        value: '{{ .params.CAPACITY_TYPE }}'
      - name: instance_type
        value: '{{ .params.INSTANCE_TYPE }}'
      - name: shrink
        value: '{{ .params.SHRINK }}'
    sourceRef:
      kind: GitRepository
      name: flux-system
      namespace: flux-system

